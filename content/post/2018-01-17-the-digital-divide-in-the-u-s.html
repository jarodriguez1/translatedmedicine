---
title: The Digital Divide in the U.S.
author: Jorge A Rodriguez MD
date: '2018-01-17'
slug: the-digital-divide-in-the-u-s
---

<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/leaflet/leaflet.css" rel="stylesheet" />
<script src="/rmarkdown-libs/leaflet/leaflet.js"></script>
<link href="/rmarkdown-libs/leafletfix/leafletfix.css" rel="stylesheet" />
<link href="/rmarkdown-libs/leaflet-label/leaflet.label.css" rel="stylesheet" />
<script src="/rmarkdown-libs/leaflet-label/leaflet.label.js"></script>
<script src="/rmarkdown-libs/Proj4Leaflet/proj4-compressed.js"></script>
<script src="/rmarkdown-libs/Proj4Leaflet/proj4leaflet.js"></script>
<script src="/rmarkdown-libs/leaflet-binding/leaflet.js"></script>
<script src="/rmarkdown-libs/leaflet.extras-utils/leaflet_extras-utils.js"></script>


<div id="htmlwidget-1" style="width:900px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"options":{"minZoom":-1.5,"maxZoom":-1.5,"crs":{"crsClass":"L.CRS.Simple","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"dragging":false,"zoomControl":false,"tap":false,"attributionControl":false},"calls":[{"method":"addPolygons","args":[[[[{"lng":[1712.80579859589,1781.31803053973,1849.83026248356,1849.83026248356,1781.31803053973,1712.80579859589,1712.80579859589],"lat":[197.777777777778,158.222222222222,197.777777777778,276.888888888889,316.444444444444,276.888888888889,197.777777777778]}]],[[{"lng":[753.634551382191,822.146783326027,890.659015269863,890.659015269863,822.146783326027,753.634551382191,753.634551382191],"lat":[909.777777777778,870.222222222222,909.777777777778,988.888888888889,1028.44444444444,988.888888888889,909.777777777778]}]],[[{"lng":[1164.7079430452,1233.22017498904,1301.73240693288,1301.73240693288,1233.22017498904,1164.7079430452,1164.7079430452],"lat":[197.777777777778,158.222222222222,197.777777777778,276.888888888889,316.444444444444,276.888888888889,197.777777777778]}]],[[{"lng":[1507.26910276438,1575.78133470822,1644.29356665205,1644.29356665205,1575.78133470822,1507.26910276438,1507.26910276438],"lat":[316.444444444444,276.888888888889,316.444444444444,395.555555555556,435.111111111111,395.555555555556,316.444444444444]}]],[[{"lng":[959.171247213698,1027.68347915753,1096.19571110137,1096.19571110137,1027.68347915753,959.171247213698,959.171247213698],"lat":[316.444444444444,276.888888888889,316.444444444444,395.555555555556,435.111111111111,395.555555555556,316.444444444444]}]],[[{"lng":[1164.7079430452,1233.22017498904,1301.73240693288,1301.73240693288,1233.22017498904,1164.7079430452,1164.7079430452],"lat":[435.111111111111,395.555555555556,435.111111111111,514.222222222222,553.777777777778,514.222222222222,435.111111111111]}]],[[{"lng":[2192.39142220274,2260.90365414657,2329.41588609041,2329.41588609041,2260.90365414657,2192.39142220274,2192.39142220274],"lat":[553.777777777778,514.222222222222,553.777777777778,632.888888888889,672.444444444444,632.888888888889,553.777777777778]}]],[[{"lng":[2123.8791902589,2192.39142220274,2260.90365414657,2260.90365414657,2192.39142220274,2123.8791902589,2123.8791902589],"lat":[435.111111111111,395.555555555556,435.111111111111,514.222222222222,553.777777777778,514.222222222222,435.111111111111]}]],[[{"lng":[2055.36695831507,2123.8791902589,2192.39142220274,2192.39142220274,2123.8791902589,2055.36695831507,2055.36695831507],"lat":[316.444444444444,276.888888888889,316.444444444444,395.555555555556,435.111111111111,395.555555555556,316.444444444444]}]],[[{"lng":[1781.31803053973,1849.83026248356,1918.3424944274,1918.3424944274,1849.83026248356,1781.31803053973,1781.31803053973],"lat":[79.1111111111111,39.5555555555556,79.1111111111111,158.222222222222,197.777777777778,158.222222222222,79.1111111111111]}]],[[{"lng":[1849.83026248356,1918.3424944274,1986.85472637123,1986.85472637123,1918.3424944274,1849.83026248356,1849.83026248356],"lat":[197.777777777778,158.222222222222,197.777777777778,276.888888888889,316.444444444444,276.888888888889,197.777777777778]}]],[[{"lng":[685.122319438356,753.634551382191,822.146783326027,822.146783326027,753.634551382191,685.122319438356,685.122319438356],"lat":[79.1111111111111,39.5555555555556,79.1111111111111,158.222222222222,197.777777777778,158.222222222222,79.1111111111111]}]],[[{"lng":[959.171247213698,1027.68347915753,1096.19571110137,1096.19571110137,1027.68347915753,959.171247213698,959.171247213698],"lat":[553.777777777778,514.222222222222,553.777777777778,632.888888888889,672.444444444444,632.888888888889,553.777777777778]}]],[[{"lng":[1507.26910276438,1575.78133470822,1644.29356665205,1644.29356665205,1575.78133470822,1507.26910276438,1507.26910276438],"lat":[553.777777777778,514.222222222222,553.777777777778,632.888888888889,672.444444444444,632.888888888889,553.777777777778]}]],[[{"lng":[1644.29356665205,1712.80579859589,1781.31803053973,1781.31803053973,1712.80579859589,1644.29356665205,1644.29356665205],"lat":[553.777777777778,514.222222222222,553.777777777778,632.888888888889,672.444444444444,632.888888888889,553.777777777778]}]],[[{"lng":[1370.24463887671,1438.75687082055,1507.26910276438,1507.26910276438,1438.75687082055,1370.24463887671,1370.24463887671],"lat":[553.777777777778,514.222222222222,553.777777777778,632.888888888889,672.444444444444,632.888888888889,553.777777777778]}]],[[{"lng":[1370.24463887671,1438.75687082055,1507.26910276438,1507.26910276438,1438.75687082055,1370.24463887671,1370.24463887671],"lat":[316.444444444444,276.888888888889,316.444444444444,395.555555555556,435.111111111111,395.555555555556,316.444444444444]}]],[[{"lng":[1575.78133470822,1644.29356665205,1712.80579859589,1712.80579859589,1644.29356665205,1575.78133470822,1575.78133470822],"lat":[435.111111111111,395.555555555556,435.111111111111,514.222222222222,553.777777777778,514.222222222222,435.111111111111]}]],[[{"lng":[1438.75687082055,1507.26910276438,1575.78133470822,1575.78133470822,1507.26910276438,1438.75687082055,1438.75687082055],"lat":[197.777777777778,158.222222222222,197.777777777778,276.888888888889,316.444444444444,276.888888888889,197.777777777778]}]],[[{"lng":[2260.90365414657,2329.41588609041,2397.92811803425,2397.92811803425,2329.41588609041,2260.90365414657,2260.90365414657],"lat":[909.777777777778,870.222222222222,909.777777777778,988.888888888889,1028.44444444444,988.888888888889,909.777777777778]}]],[[{"lng":[1986.85472637123,2055.36695831507,2123.8791902589,2123.8791902589,2055.36695831507,1986.85472637123,1986.85472637123],"lat":[435.111111111111,395.555555555556,435.111111111111,514.222222222222,553.777777777778,514.222222222222,435.111111111111]}]],[[{"lng":[2123.8791902589,2192.39142220274,2260.90365414657,2260.90365414657,2192.39142220274,2123.8791902589,2123.8791902589],"lat":[672.444444444444,632.888888888889,672.444444444444,751.555555555556,791.111111111111,751.555555555556,672.444444444444]}]],[[{"lng":[1712.80579859589,1781.31803053973,1849.83026248356,1849.83026248356,1781.31803053973,1712.80579859589,1712.80579859589],"lat":[672.444444444444,632.888888888889,672.444444444444,751.555555555556,791.111111111111,751.555555555556,672.444444444444]}]],[[{"lng":[1301.73240693288,1370.24463887671,1438.75687082055,1438.75687082055,1370.24463887671,1301.73240693288,1301.73240693288],"lat":[672.444444444444,632.888888888889,672.444444444444,751.555555555556,791.111111111111,751.555555555556,672.444444444444]}]],[[{"lng":[1575.78133470822,1644.29356665205,1712.80579859589,1712.80579859589,1644.29356665205,1575.78133470822,1575.78133470822],"lat":[197.777777777778,158.222222222222,197.777777777778,276.888888888889,316.444444444444,276.888888888889,197.777777777778]}]],[[{"lng":[1438.75687082055,1507.26910276438,1575.78133470822,1575.78133470822,1507.26910276438,1438.75687082055,1438.75687082055],"lat":[435.111111111111,395.555555555556,435.111111111111,514.222222222222,553.777777777778,514.222222222222,435.111111111111]}]],[[{"lng":[1027.68347915753,1096.19571110137,1164.7079430452,1164.7079430452,1096.19571110137,1027.68347915753,1027.68347915753],"lat":[672.444444444444,632.888888888889,672.444444444444,751.555555555556,791.111111111111,751.555555555556,672.444444444444]}]],[[{"lng":[1301.73240693288,1370.24463887671,1438.75687082055,1438.75687082055,1370.24463887671,1301.73240693288,1301.73240693288],"lat":[435.111111111111,395.555555555556,435.111111111111,514.222222222222,553.777777777778,514.222222222222,435.111111111111]}]],[[{"lng":[1027.68347915753,1096.19571110137,1164.7079430452,1164.7079430452,1096.19571110137,1027.68347915753,1027.68347915753],"lat":[435.111111111111,395.555555555556,435.111111111111,514.222222222222,553.777777777778,514.222222222222,435.111111111111]}]],[[{"lng":[2192.39142220274,2260.90365414657,2329.41588609041,2329.41588609041,2260.90365414657,2192.39142220274,2192.39142220274],"lat":[791.111111111111,751.555555555556,791.111111111111,870.222222222222,909.777777777778,870.222222222222,791.111111111111]}]],[[{"lng":[2055.36695831507,2123.8791902589,2192.39142220274,2192.39142220274,2123.8791902589,2055.36695831507,2055.36695831507],"lat":[553.777777777778,514.222222222222,553.777777777778,632.888888888889,672.444444444444,632.888888888889,553.777777777778]}]],[[{"lng":[1233.22017498904,1301.73240693288,1370.24463887671,1370.24463887671,1301.73240693288,1233.22017498904,1233.22017498904],"lat":[316.444444444444,276.888888888889,316.444444444444,395.555555555556,435.111111111111,395.555555555556,316.444444444444]}]],[[{"lng":[1986.85472637123,2055.36695831507,2123.8791902589,2123.8791902589,2055.36695831507,1986.85472637123,1986.85472637123],"lat":[672.444444444444,632.888888888889,672.444444444444,751.555555555556,791.111111111111,751.555555555556,672.444444444444]}]],[[{"lng":[1781.31803053973,1849.83026248356,1918.3424944274,1918.3424944274,1849.83026248356,1781.31803053973,1781.31803053973],"lat":[316.444444444444,276.888888888889,316.444444444444,395.555555555556,435.111111111111,395.555555555556,316.444444444444]}]],[[{"lng":[1164.7079430452,1233.22017498904,1301.73240693288,1301.73240693288,1233.22017498904,1164.7079430452,1164.7079430452],"lat":[672.444444444444,632.888888888889,672.444444444444,751.555555555556,791.111111111111,751.555555555556,672.444444444444]}]],[[{"lng":[1781.31803053973,1849.83026248356,1918.3424944274,1918.3424944274,1849.83026248356,1781.31803053973,1781.31803053973],"lat":[553.777777777778,514.222222222222,553.777777777778,632.888888888889,672.444444444444,632.888888888889,553.777777777778]}]],[[{"lng":[1301.73240693288,1370.24463887671,1438.75687082055,1438.75687082055,1370.24463887671,1301.73240693288,1301.73240693288],"lat":[197.777777777778,158.222222222222,197.777777777778,276.888888888889,316.444444444444,276.888888888889,197.777777777778]}]],[[{"lng":[890.659015269863,959.171247213698,1027.68347915753,1027.68347915753,959.171247213698,890.659015269863,890.659015269863],"lat":[435.111111111111,395.555555555556,435.111111111111,514.222222222222,553.777777777778,514.222222222222,435.111111111111]}]],[[{"lng":[1918.3424944274,1986.85472637123,2055.36695831507,2055.36695831507,1986.85472637123,1918.3424944274,1918.3424944274],"lat":[553.777777777778,514.222222222222,553.777777777778,632.888888888889,672.444444444444,632.888888888889,553.777777777778]}]],[[{"lng":[2260.90365414657,2329.41588609041,2397.92811803425,2397.92811803425,2329.41588609041,2260.90365414657,2260.90365414657],"lat":[672.444444444444,632.888888888889,672.444444444444,751.555555555556,791.111111111111,751.555555555556,672.444444444444]}]],[[{"lng":[1918.3424944274,1986.85472637123,2055.36695831507,2055.36695831507,1986.85472637123,1918.3424944274,1918.3424944274],"lat":[316.444444444444,276.888888888889,316.444444444444,395.555555555556,435.111111111111,395.555555555556,316.444444444444]}]],[[{"lng":[1233.22017498904,1301.73240693288,1370.24463887671,1370.24463887671,1301.73240693288,1233.22017498904,1233.22017498904],"lat":[553.777777777778,514.222222222222,553.777777777778,632.888888888889,672.444444444444,632.888888888889,553.777777777778]}]],[[{"lng":[1644.29356665205,1712.80579859589,1781.31803053973,1781.31803053973,1712.80579859589,1644.29356665205,1644.29356665205],"lat":[316.444444444444,276.888888888889,316.444444444444,395.555555555556,435.111111111111,395.555555555556,316.444444444444]}]],[[{"lng":[1370.24463887671,1438.75687082055,1507.26910276438,1507.26910276438,1438.75687082055,1370.24463887671,1370.24463887671],"lat":[79.1111111111111,39.5555555555556,79.1111111111111,158.222222222222,197.777777777778,158.222222222222,79.1111111111111]}]],[[{"lng":[1096.19571110137,1164.7079430452,1233.22017498904,1233.22017498904,1164.7079430452,1096.19571110137,1096.19571110137],"lat":[316.444444444444,276.888888888889,316.444444444444,395.555555555556,435.111111111111,395.555555555556,316.444444444444]}]],[[{"lng":[2055.36695831507,2123.8791902589,2192.39142220274,2192.39142220274,2123.8791902589,2055.36695831507,2055.36695831507],"lat":[791.111111111111,751.555555555556,791.111111111111,870.222222222222,909.777777777778,870.222222222222,791.111111111111]}]],[[{"lng":[1849.83026248356,1918.3424944274,1986.85472637123,1986.85472637123,1918.3424944274,1849.83026248356,1849.83026248356],"lat":[435.111111111111,395.555555555556,435.111111111111,514.222222222222,553.777777777778,514.222222222222,435.111111111111]}]],[[{"lng":[890.659015269863,959.171247213698,1027.68347915753,1027.68347915753,959.171247213698,890.659015269863,890.659015269863],"lat":[672.444444444444,632.888888888889,672.444444444444,751.555555555556,791.111111111111,751.555555555556,672.444444444444]}]],[[{"lng":[1712.80579859589,1781.31803053973,1849.83026248356,1849.83026248356,1781.31803053973,1712.80579859589,1712.80579859589],"lat":[435.111111111111,395.555555555556,435.111111111111,514.222222222222,553.777777777778,514.222222222222,435.111111111111]}]],[[{"lng":[1438.75687082055,1507.26910276438,1575.78133470822,1575.78133470822,1507.26910276438,1438.75687082055,1438.75687082055],"lat":[672.444444444444,632.888888888889,672.444444444444,751.555555555556,791.111111111111,751.555555555556,672.444444444444]}]],[[{"lng":[1096.19571110137,1164.7079430452,1233.22017498904,1233.22017498904,1164.7079430452,1096.19571110137,1096.19571110137],"lat":[553.777777777778,514.222222222222,553.777777777778,632.888888888889,672.444444444444,632.888888888889,553.777777777778]}]]],null,"state",{"lineCap":null,"lineJoin":null,"clickable":true,"pointerEvents":null,"className":"","stroke":true,"color":"#000000","weight":2,"opacity":1,"fill":true,"fillColor":["#F89441","#0D0887","#7E03A8","#F89441","#0D0887","#0D0887","#7E03A8","#7E03A8","#CC4779","#7E03A8","#CC4779","#7E03A8","#CC4779","#7E03A8","#CC4779","#CC4779","#CC4779","#F89441","#F89441","#7E03A8","#0D0887","#0D0887","#CC4779","#7E03A8","#F0F921","#CC4779","#CC4779","#7E03A8","#7E03A8","#0D0887","#7E03A8","#F0F921","#7E03A8","#CC4779","#7E03A8","#CC4779","#CC4779","#0D0887","#CC4779","#7E03A8","#F89441","#CC4779","#F89441","#CC4779","#0D0887","#7E03A8","#7E03A8","#0D0887","#F89441","#7E03A8","#7E03A8"],"fillOpacity":0.6,"dashArray":null,"smoothFactor":1,"noClip":false},["21.5%","11.5%","14%","22.5%","11.9%","9.9%","12.8%","13.2%","17.6%","14.7%","15.8%","12.4%","17%","14.7%","17.3%","16%","15.9%","19.3%","22.2%","14.6%","11.3%","11.9%","15.9%","13%","25.7%","16.7%","16.4%","15%","15.7%","10.5%","12.4%","22.6%","14.9%","17.3%","14.1%","16.1%","19.1%","11.7%","16.4%","15%","19.4%","16.2%","19.6%","16.3%","9.2%","13.7%","13.7%","9.5%","21.4%","15.3%","13.5%"],null,null,null,{"weight":4}]},{"method":"addMarkers","args":[[237.333333333333,949.333333333333,237.333333333333,356,356,474.666666666667,593.333333333333,474.666666666667,356,118.666666666667,237.333333333333,118.666666666667,593.333333333333,593.333333333333,593.333333333333,593.333333333333,356,474.666666666667,237.333333333333,949.333333333333,474.666666666667,712,712,712,237.333333333333,474.666666666667,712,474.666666666667,474.666666666667,830.666666666667,593.333333333333,356,712,356,712,593.333333333333,237.333333333333,474.666666666667,593.333333333333,712,356,593.333333333333,356,118.666666666667,356,830.666666666667,474.666666666667,712,474.666666666667,712,593.333333333333],[1781.31803053972,822.146783326027,1233.22017498904,1575.78133470822,1027.68347915753,1233.22017498904,2260.90365414657,2192.39142220274,2123.8791902589,1849.83026248356,1918.3424944274,753.634551382191,1027.68347915753,1575.78133470822,1712.80579859589,1438.75687082055,1438.75687082055,1644.29356665205,1507.26910276438,2329.41588609041,2055.36695831507,2192.39142220274,1781.31803053973,1370.24463887671,1644.29356665205,1507.26910276438,1096.19571110137,1370.24463887671,1096.19571110137,2260.90365414657,2123.8791902589,1301.73240693288,2055.36695831507,1849.83026248356,1233.22017498904,1849.83026248356,1370.24463887671,959.171247213698,1986.85472637123,2329.41588609041,1986.85472637123,1301.73240693288,1712.80579859589,1438.75687082055,1164.70794304521,2123.8791902589,1918.3424944274,959.171247213698,1781.31803053973,1507.26910276438,1164.70794304521],{"iconUrl":{"data":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR4nGP6zwAAAgcBApocMXEAAAAASUVORK5CYII=","index":0},"iconWidth":1,"iconHeight":1},null,null,{"clickable":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,["AL","AK","AZ","AR","CA","CO","CT","DE","DC","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"],{"clickable":false,"noHide":"T","direction":"right","opacity":1,"offset":[-4,-10],"textsize":"12px","textOnly":true,"style":null,"zoomAnimation":true,"className":""},null]},{"method":"addLegend","args":[{"colors":["#0D0887","#7E03A8","#CC4779","#F89441","#F0F921"],"labels":["9.0 &ndash; 12.4%","12.4 &ndash; 15.8%","15.8 &ndash; 19.2%","19.2 &ndash; 22.6%","22.6 &ndash; 26.0%"],"na_color":null,"na_label":"NA","opacity":0.7,"position":"bottomright","type":"bin","title":"Percent of Households Without Internet","extra":null,"layerId":null,"className":"info legend"}]},{"method":"setMapWidgetStyle","args":[{"background":"transparent"}]}],"limits":{"lat":[39.5555555555556,1028.44444444444],"lng":[685.122319438356,2397.92811803425]}},"evals":[],"jsHooks":[]}</script>
<p>With the release of the <a href="https://www.census.gov/programs-surveys/acs/news/data-releases.html">American Community Survey</a>, there was an opportunity to take a look at the digital divide in 2016.</p>
<p>I was inspired to make a tilegram map similar to those create by <a href="http://blog.apps.npr.org/2015/05/11/hex-tile-maps.html">NPR</a>. I used the tilegramsR package by <a href="https://bhaskarvk.github.io/tilegramsR/">Bhaskar Karambelkar</a>.</p>
<p>First, here are the packages for the job.</p>
<pre class="r"><code>#Data clean up
library(tidyverse) 

#Obtaining Census data
library(tidycensus) 

#Needed to create tilegram map
library(tilegramsR) 
library(leaflet)
library(leaflet.extras)
library(viridis)</code></pre>
<div id="census-data" class="section level3">
<h3>Census Data</h3>
<p>I obtained state level data from the 1 year American Community Survey from 2016:</p>
<pre class="r"><code>stateNoInt = get_acs(geography = &quot;state&quot;, variables = c(&quot;B28002_013E&quot;, &quot;B28002_001E&quot;), survey = &quot;acs1&quot;)
#B28002_013E --&gt; No Internet Access
#B28002_001E --&gt; Total population</code></pre>
<p>I tidy-ed the data so that each row represented one state. I also created the percent column.</p>
<pre class="r"><code>stateNoInt.final= stateNoInt %&gt;% select(-moe) %&gt;%  spread(variable, estimate) %&gt;% 
  mutate(percent = (B28002_013/ B28002_001)*100)</code></pre>
<p>The census data uses full state names, while the map data uses state abbreviations. To join the dataframes, I had to match the full state names to the state abbreviations:</p>
<pre class="r"><code>for (i in 1:nrow(stateNoInt.final)) {
  x = stateNoInt.final$NAME[i]
  stateNoInt.final$state[i] = state.abb[match(x,state.name)]
}</code></pre>
<p>A few corrections (sorry, Puerto Rico):</p>
<pre class="r"><code>stateNoInt.final$state[9] = &quot;DC&quot;
stateNoInt.final = stateNoInt.final[-52,]</code></pre>
</div>
<div id="making-the-map" class="section level3">
<h3>Making the Map</h3>
<p>The simple features(sf) maps are provided by the tilegramR package:</p>
<pre class="r"><code>baseMap = sf_NPR1to1
baseMap.centers = sf_NPR1to1.centers</code></pre>
<p>Joining the census data with the maps data:</p>
<pre class="r"><code>stateNoInt.final.joined = right_join(baseMap, stateNoInt.final, by=&quot;state&quot;)
stateNoInt.final.joined.centers = right_join(baseMap.centers, stateNoInt.final, by=&quot;state&quot;)</code></pre>
<p>This part of the code comes from <a href="http://rpubs.com/bhaskarvk/tilegramsR">Rpubs by Bhaskar Karambelkar</a>:</p>
<pre class="r"><code>getLeafletOptions &lt;- function(minZoom, maxZoom, ...) {
  leafletOptions(
    crs = leafletCRS(&quot;L.CRS.Simple&quot;),
    minZoom = minZoom, maxZoom = maxZoom,
    dragging = FALSE, zoomControl = FALSE,
    tap = FALSE,
    attributionControl = FALSE , ...)
}</code></pre>
<p>I created the bins for the data prior to mapping. The rest of the code is adapted from <a href="http://rpubs.com/bhaskarvk/tilegramsR">Rpubs</a> and it creates the final map:</p>
<pre class="r"><code>int.pal = colorBin(&quot;plasma&quot;, round(stateNoInt.final.joined.centers$percent), pretty=FALSE, 5)

tileGramMap = leaflet(
  stateNoInt.final.joined,
  options= getLeafletOptions(-1, -1)) %&gt;%
  addPolygons(
    weight=2,color=&#39;#000000&#39;, group = &#39;state&#39;,
    fillOpacity = 0.6, opacity = 1, fillColor= ~int.pal(percent),
    highlightOptions = highlightOptions(weight = 4), 
    popup = as.character(round(stateNoInt.final.joined$percent, 1))) %&gt;%
  addLabelOnlyMarkers(
    data=stateNoInt.final.joined.centers,
    label = ~as.character(state),
    labelOptions = labelOptions(
      noHide = &#39;T&#39;, textOnly = T,
      offset=c(-4,-10), textsize = &#39;12px&#39;)) %&gt;%
  addLegend(pal = int.pal, values = ~percent, opacity = 0.7, position = &quot;bottomright&quot;,  
            labFormat = labelFormat(suffix  = &quot;%&quot;), title=&quot;Percent of Households Without Internet&quot;) %&gt;% 
  setMapWidgetStyle()</code></pre>
</div>
